<!DOCTYPE html>
<html>
<head><meta name="generator" content="Hexo 3.8.0">
  <!-- hexo-inject:begin --><!-- hexo-inject:end --><meta charset="utf-8">
  <title>Band Structure calculation (Hybird functional) | VASPKIT</title>
  <meta name="keywords" content=" VASP , 能带 ">
  <meta name="description" content="Band Structure calculation (Hybird functional) | VASPKIT">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
<meta name="description" content="########## citation ########## Ve WANG, Nan XU, Jin-Cheng LIU VASPKIT: A Pre- and Post-Processing Program for the VASP Code. http://vaspkit.sourceforge.net. ########## citation ##########  The Vienna">
<meta property="og:type" content="article">
<meta property="og:title" content="VASPKIT v0.80 Menual">
<meta property="og:url" content="http://vaspkit.com/2019/06/20/quick-start/index.html">
<meta property="og:site_name" content="VASPKIT">
<meta property="og:description" content="########## citation ########## Ve WANG, Nan XU, Jin-Cheng LIU VASPKIT: A Pre- and Post-Processing Program for the VASP Code. http://vaspkit.sourceforge.net. ########## citation ##########  The Vienna">
<meta property="og:locale" content="English">
<meta property="og:image" content="http://vaspkit.com/images/vaspkit-manual/vaspkit-manual1.jpg">
<meta property="og:updated_time" content="2019-06-20T10:53:15.419Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="VASPKIT v0.80 Menual">
<meta name="twitter:description" content="########## citation ########## Ve WANG, Nan XU, Jin-Cheng LIU VASPKIT: A Pre- and Post-Processing Program for the VASP Code. http://vaspkit.sourceforge.net. ########## citation ##########  The Vienna">
<meta name="twitter:image" content="http://vaspkit.com/images/vaspkit-manual/vaspkit-manual1.jpg">


<link rel="icon" href="/img/avatar.jpg">

<link href="/css/style.css?v=1" rel="stylesheet">

<link href="/css/hl_theme/atom-light.css?v=1" rel="stylesheet">

<link href="//cdn.bootcss.com/animate.css/3.5.2/animate.min.css" rel="stylesheet">
<link href="//cdn.bootcss.com/font-awesome/4.7.0/css/font-awesome.min.css" rel="stylesheet">

<script src="//cdn.bootcss.com/jquery/2.2.4/jquery.min.js"></script>
<script src="/js/jquery.autocomplete.min.js?v=1"></script>

<script src="//cdn.bootcss.com/highlight.js/9.12.0/highlight.min.js"></script>
<script>
    hljs.initHighlightingOnLoad();
</script>

<script src="//cdn.bootcss.com/nprogress/0.2.0/nprogress.min.js"></script>



<script src="//cdn.bootcss.com/jquery-cookie/1.4.1/jquery.cookie.min.js"></script>

<script src="/js/iconfont.js?v=1"></script><!-- hexo-inject:begin --><!-- hexo-inject:end -->

</head>
<div style="display: none">
  <input class="theme_disqus_on" value="false">
  <input class="theme_preload_comment" value="false">
  <input class="theme_blog_path" value>
</div>

<body>
<!-- hexo-inject:begin --><!-- hexo-inject:end --><aside class="nav">
    <div class="nav-left">
        <a href="/" class="avatar_target">
    <img class="avatar" src="/img/avatar.jpg">
</a>
<div class="author">
    <span>VASPKIT</span>
</div>

<div class="icon">
    
        
        <a title="rss" href="/atom.xml" target="_blank">
            
                <svg class="iconfont-svg" aria-hidden="true">
                    <use xlink:href="#icon-rss"/>
                </svg>
            
        </a>
        
    
        
        <a title="github" href="https://github.com/tamaswells/VASPKIT_manual" target="_blank">
            
                <svg class="iconfont-svg" aria-hidden="true">
                    <use xlink:href="#icon-github"/>
                </svg>
            
        </a>
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
        <a title="email" href="mailto:vaspkit@gmail.com" target="_blank">
            
                <svg class="iconfont-svg" aria-hidden="true">
                    <use xlink:href="#icon-email"/>
                </svg>
            
        </a>
        
    
</div>




<ul>
    <li><div class="all active">全部文章<small>(7)</small></div></li>
    
        
            
            <li><div data-rel="vaspkit">vaspkit<small>(7)</small></div>
                
            </li>
            
        
    
</ul>
<div class="left-bottom">
    <div class="menus">
    
    
    
    
    </div>
    <div><a style="border-right: 1px solid #fff; width: 49%" class="about site_url" href="/about">关于</a><a style="width: 50%" class="friends">友链</a></div>
</div>
<input type="hidden" id="yelog_site_posts_number" value="7">

<div style="display: none">
    <span id="busuanzi_value_site_uv"></span>
    <span id="busuanzi_value_site_pv"></span>
</div>

    </div>
    <div class="nav-right">
        <div class="friends-area">
    <div class="friends-title">
        友情链接
        <i class="back-title-list"></i>
    </div>
    <div class="friends-content">
        <ul>
            
            <li><a target="_blank" href="/www.vasp.at">VASP</a></li>
            
        </ul>
    </div>
</div>
        <div class="title-list">
    <form onkeydown="if(event.keyCode==13){return false;}">
        <input class="search" type="text" placeholder="Search..." autocomplete="off" id="local-search-input">
        <i class="cross"></i>
        <span>
            <label for="tagswitch">Tags:</label>
            <input id="tagswitch" type="checkbox" style="display: none">
            <i id="tagsWitchIcon"></i>
        </span>
    </form>
    <div class="tags-list">
    
    <li class="article-tag-list-item">
        <a href="javascript:" class="color5">VASP</a>
    </li>
    
    <li class="article-tag-list-item">
        <a href="javascript:" class="color3">能带</a>
    </li>
    
    <li class="article-tag-list-item">
        <a href="javascript:" class="color3">vaspkit</a>
    </li>
    
    <li class="article-tag-list-item">
        <a href="javascript:" class="color5">Band structure</a>
    </li>
    
    <div class="clearfix"></div>
</div>

    
    <nav id="title-list-nav">
        
        <a class="vaspkit " href="/2019/06/03/chgdiff/" data-tag data-author="Jincheng Liu">
            <span class="post-title" title="Charge density difference">Charge density difference</span>
            <span class="post-date" title="2019-06-03 00:00:00">2019/06/03</span>
        </a>
        
        <a class="vaspkit " href="/2019/05/19/pband/" data-tag="VASP,能带" data-author="Jincheng Liu">
            <span class="post-title" title="Draw Band Structure figure by Origin">Draw Band Structure figure by Origin</span>
            <span class="post-date" title="2019-05-19 00:00:00">2019/05/19</span>
        </a>
        
        <a class="vaspkit " href="/2019/05/21/vaspkit-avgpot/" data-tag="VASP,能带" data-author="Jincheng Liu">
            <span class="post-title" title="Plane-average Potential and Work Function">Plane-average Potential and Work Function</span>
            <span class="post-date" title="2019-05-21 00:00:00">2019/05/21</span>
        </a>
        
        <a class="vaspkit " href="/2019/06/17/vaspkit-macropot/" data-tag="VASP,vaspkit" data-author="Jincheng Liu">
            <span class="post-title" title="macroscopic-averaged potential">macroscopic-averaged potential</span>
            <span class="post-date" title="2019-06-17 00:00:00">2019/06/17</span>
        </a>
        
        <a class="vaspkit " href="/2019/05/14/band/" data-tag="VASP,Band structure" data-author="Jincheng Liu">
            <span class="post-title" title="Band Structure calculation (Pure functional)">Band Structure calculation (Pure functional)</span>
            <span class="post-date" title="2019-05-14 00:00:00">2019/05/14</span>
        </a>
        
        <a class="vaspkit " href="/2019/06/20/quick-start/" data-tag data-author="Jincheng Liu">
            <span class="post-title" title="VASPKIT v0.80 Menual">VASPKIT v0.80 Menual</span>
            <span class="post-date" title="2019-06-20 01:30:17">2019/06/20</span>
        </a>
        
        <a class="vaspkit " href="/2019/05/22/vaspkit-hse-band/" data-tag="VASP,能带" data-author="Jincheng Liu">
            <span class="post-title" title="Band Structure calculation (Hybird functional)">Band Structure calculation (Hybird functional)</span>
            <span class="post-date" title="2019-05-22 00:00:00">2019/05/22</span>
        </a>
        
    </nav>
</div>
    </div>
    <div class="hide-list">
        <div class="semicircle">
            <div class="brackets first"><</div>
            <div class="brackets">&gt;</div>
        </div>
    </div>
</aside>
<div class="post">
    <div class="pjax">
        <article id="post-vaspkit-hse-band" class="article article-type-post" itemscope itemprop="blogPost">
    
        <h1 class="article-title">Band Structure calculation (Hybird functional)</h1>
    
    <div class="article-meta">
        
        
        <span class="author"><a href="javascript:">Jincheng Liu</a></span>
        
        
        <span class="book">
            
                <a href="javascript:" data-rel="vaspkit">vaspkit</a>
            
        </span>
        
        
        <span class="tag">
            
            <a href="javascript:" class="color5">VASP</a>
            
            <a href="javascript:" class="color3">能带</a>
            
        </span>
        
    </div>
    <div class="article-meta">
        
        创建时间:<time class="date" title="更新时间: 2019-06-19 21:15:04">2019-05-22 00:00</time>
        
    </div>
    <div class="article-meta">
        
        
        <span id="busuanzi_container_page_pv">
            阅读:<span id="busuanzi_value_page_pv">
                <span class="count-comment">
                    <span class="spinner">
                      <div class="cube1"></div>
                      <div class="cube2"></div>
                    </span>
                </span>
            </span>
        </span>
        
        
    </div>
    
    <div class="toc-ref">
    
        <ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#Example-single-layer-MoS2"><span class="toc-text">Example: single layer MoS2</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#supplementary-hybrid-functional-band-structure-can-also-be-down-by-pymatgen"><span class="toc-text">supplementary: hybrid functional band structure can also be down by pymatgen:</span></a></li></ol>
    
<style>
    .left-col .switch-btn,
    .left-col .switch-area {
        display: none;
    }
    .toc-level-3 i,
    .toc-level-3 ol {
        display: none !important;
    }
</style>
</div>
    <div class="article-entry" itemprop="articleBody">
      
        <p><strong>########## citation ##########</strong></p>
<p><strong>V. Wang, N. Xu, Jin-Cheng Liu VASPKIT: A Pre- and Post-Processing Program for the VASP Code. <a href="http://vaspkit.sourceforge.net" target="_blank" rel="noopener">http://vaspkit.sourceforge.net</a>.</strong></p>
<p><strong>########## citation ##########</strong></p>
<p>Vaspkit can generate k-path with uniformed spacing between k points in units of 2$\pi$*Angstrom<sup>-1</sup>, which can be used to hybrid functional band structure calculations. The KPOINTS should contain two parts. First part is same as the self-consistant calculation with normal weighted k points in irreducilbe brillouin zone. And Second part is the 0-weighted k points alone the k-path. To generate such KPOINTS file:</p>
<p>(1) After geometery optimiztion. Run <strong>302</strong> (for 2D materials) or <strong>303</strong> (for 3D materials) to get:</p>
<ol>
<li>standardized primitive cell (PRIMCELL.vasp) </li>
<li>line-mode k-path for pure functional band structure calculation (KPATH.in)</li>
<li>High-symmetry points in fractional coordinates. (HIGH_SYMMETRY_POINTS) You can check them with the seekpath database [<a href="https://www.materialscloud.org/work/tools/seekpath" target="_blank" rel="noopener">https://www.materialscloud.org/work/tools/seekpath</a>]. </li>
</ol>
<p>(2) Run <strong>251</strong> to generate KPOINTS file for hybrid functional band-structure calculations. Input the k spacing values to determine density of k-mesh for SCF calculation and k-path for band structure calculation. Then vaspkit will read KPATH.in file and generate the KPOINTS file for hybrid functional band-structure calculation.</p>
<p>(3) <em>Optional</em>. Do a PBE SCF calculations based on the new generated KPOINTS file and get the wavefunctions, which can be read for next step hybrid functional calculation. Sometimes, this step can reduce the SCF time of the next step hybrid functional calculation.</p>
<p>(4) Do hybrid functional band structure calculation.</p>
<p>(5) Extract band structure information by <strong>252</strong>. band data is saved in BAND.dat and BAND-REFORMATTED.dat files. High-symmetry points positions on band structure figures are saved in KLABELS. </p>
<h2 id="Example-single-layer-MoS2"><a href="#Example-single-layer-MoS2" class="headerlink" title="Example: single layer MoS2"></a>Example: single layer MoS<sub>2</sub></h2><p>(1) After optimization. Run <strong>302</strong></p>
<pre><code>302
 +-------------------------- Warm Tips --------------------------+
     See An Example in vaspkit/examples/seek_kpath/graphene_2D.        
 This feature is still experimental &amp; check the PRIMCELL.vasp file.       
 +---------------------------------------------------------------+
 --&gt;&gt; (1) Reading Structural Parameters from POSCAR File...
 +-------------------------- Summary ----------------------------+
           The vacuum slab is supposed to be along c axis   
                           Prototype: AB2
           Total Atoms in Input Cell:   3
     Lattice Constants in Input Cell:   3.184   3.184  18.410
        Lattice Angles in Input Cell:  90.000  90.000 120.000
       Total Atoms in Primitive Cell:   3
 Lattice Constants in Primitive Cell:   3.184   3.184  18.410
    Lattice Angles in Primitive Cell:  90.000  90.000 120.000
                  2D Bravais Lattice: Hexagonal
                         Space Group: 187
                         Point Group: 26 [ D3h ]
                       International: P-6m2
                 Symmetry Operations:  12
                    Suggested K-Path: (shown in the next line)
 [ GAMMA-M-K-GAMMA ]
 +---------------------------------------------------------------+
 --&gt;&gt; (2) Written PRIMCELL.vasp file.
 --&gt;&gt; (3) Written KPATH.in File for Band-Structure Calculation.
 --&gt;&gt; (4) Written HIGH_SYMMETRY_POINTS File for Reference.
</code></pre><p>use the new generated PRIMCELL.vasp as POSCAR: <code>cp PRIMCELL.vasp POSCAR</code></p>
<pre><code>Primitive Cell
  1.000000
    3.18401832481292    0.00000000000000    0.00000000000000
   -1.59200916240646    2.75744075540316    0.00000000000000
    0.00000000000000    0.00000000000000   18.40999984740000
  S   Mo
   2   1
DIRECT
    0.0000000000000000    0.0000000000000000    0.4151505217091287     S1
    0.0000000000000000    0.0000000000000000    0.5848494782908713     S2
    0.6666666666666666    0.3333333333333333    0.5000000000000000    Mo1
</code></pre><p>KPATH.in:</p>
<pre><code>K-Path Generated by VASPKIT.
   20
Line-Mode
Reciprocal
   0.0000000000   0.0000000000   0.0000000000     GAMMA          
   0.5000000000   0.0000000000   0.0000000000     M              

   0.5000000000   0.0000000000   0.0000000000     M              
   0.3333333333   0.3333333333   0.0000000000     K              

   0.3333333333   0.3333333333   0.0000000000     K              
   0.0000000000   0.0000000000   0.0000000000     GAMMA
</code></pre><p>(2) Run <strong>251</strong> to generate KPOINTS file for hybrid functional band-structure calculations. </p>
<pre><code>251
 --&gt;&gt; (1) Reading Structural Parameters from POSCAR File...
 ======================= K-Mesh Scheme ==========================
 1) Monkhorst-Pack Scheme                            
 2) Gamma Scheme                                     

 0)   Quit                                             
 9)   Back                                             
 -------------&gt;&gt;
2
 +-------------------------- Warm Tips --------------------------+
 Input Resolution Value to Determine K-Mesh for SCF Calculation: 
 (Typical Value: 0.03-0.04 is Generally Precise Enough)
 ------------&gt;&gt;
0.05
 Input Resolution Value along K-Path for Band Calculation: 
 (Typical Value: 0.02-0.04 for DFT and 0.04-0.06 for hybrid DFT)
 ------------&gt;&gt;
0.05
 +---------------------------------------------------------------+
 --&gt;&gt; (2) Reading K-Paths From KPATH.in File...
 +-------------------------- Summary ----------------------------+
 K-Mesh for SCF Calculation:    7    7    1
 The Number of K-Point along K-Path 1:  22
 The Number of K-Point along K-Path 2:  13
 The Number of K-Point along K-Path 3:  26
 +---------------------------------------------------------------+
 --&gt;&gt; (3) Written KPOINTS File!
</code></pre><p>Select (1) Monkhorst-Pack Scheme or (2) Gamma Scheme to generate k-mesh for SCF calculation. The allowed spacing between k points is set to be 0.04. Then also set the spacing between k points on k-path as 0.04. </p>
<p>Vaspkit will output the k-mesh for SCF Calculation:    7    7    1. And the number of k-points along each line of k-path:  $\Gamma$-&gt; M : 22,    M -&gt; K : 13,    K -&gt; $\Gamma$ : 26. </p>
<pre><code>Parameters to Generate KPOINTS (Don&#39;t Edit This Line):   0.050  0.050    8   61   3  22  13  26
    69
Reciprocal lattice
    0.00000000000000    0.00000000000000    0.00000000000000     1
    0.14285714285714    0.00000000000000    0.00000000000000     6
    0.28571428571429    0.00000000000000    0.00000000000000     6
    0.42857142857143    0.00000000000000    0.00000000000000     6
    0.14285714285714    0.14285714285714    0.00000000000000     6
    0.28571428571429    0.14285714285714    0.00000000000000    12
    0.42857142857143    0.14285714285714    0.00000000000000     6
    0.28571428571429    0.28571428571429    0.00000000000000     6
    0.00000000000000    0.00000000000000    0.00000000000000     0
    0.02380952380952    0.00000000000000    0.00000000000000     0
    0.04761904761905    0.00000000000000    0.00000000000000     0
    0.07142857142857    0.00000000000000    0.00000000000000     0
    0.09523809523810    0.00000000000000    0.00000000000000     0
    0.11904761904762    0.00000000000000    0.00000000000000     0
    0.14285714285714    0.00000000000000    0.00000000000000     0
    0.16666666666667    0.00000000000000    0.00000000000000     0
    0.19047619047619    0.00000000000000    0.00000000000000     0
    0.21428571428571    0.00000000000000    0.00000000000000     0
    0.23809523809524    0.00000000000000    0.00000000000000     0
    0.26190476190476    0.00000000000000    0.00000000000000     0
    0.28571428571429    0.00000000000000    0.00000000000000     0
    0.30952380952381    0.00000000000000    0.00000000000000     0
    0.33333333333333    0.00000000000000    0.00000000000000     0
    0.35714285714286    0.00000000000000    0.00000000000000     0
    0.38095238095238    0.00000000000000    0.00000000000000     0
    0.40476190476190    0.00000000000000    0.00000000000000     0
    0.42857142857143    0.00000000000000    0.00000000000000     0
    0.45238095238095    0.00000000000000    0.00000000000000     0
    0.47619047619048    0.00000000000000    0.00000000000000     0
    0.50000000000000    0.00000000000000    0.00000000000000     0
    0.50000000000000    0.00000000000000    0.00000000000000     0
    0.48611111110833    0.02777777777500    0.00000000000000     0
    0.47222222221667    0.05555555555000    0.00000000000000     0
    0.45833333332500    0.08333333332500    0.00000000000000     0
    0.44444444443333    0.11111111110000    0.00000000000000     0
    0.43055555554167    0.13888888887500    0.00000000000000     0
    0.41666666665000    0.16666666665000    0.00000000000000     0
    0.40277777775833    0.19444444442500    0.00000000000000     0
    0.38888888886667    0.22222222220000    0.00000000000000     0
    0.37499999997500    0.24999999997500    0.00000000000000     0
    0.36111111108333    0.27777777775000    0.00000000000000     0
    0.34722222219167    0.30555555552500    0.00000000000000     0
    0.33333333330000    0.33333333330000    0.00000000000000     0
    0.33333333330000    0.33333333330000    0.00000000000000     0
    0.31999999996800    0.31999999996800    0.00000000000000     0
    0.30666666663600    0.30666666663600    0.00000000000000     0
    0.29333333330400    0.29333333330400    0.00000000000000     0
    0.27999999997200    0.27999999997200    0.00000000000000     0
    0.26666666664000    0.26666666664000    0.00000000000000     0
    0.25333333330800    0.25333333330800    0.00000000000000     0
    0.23999999997600    0.23999999997600    0.00000000000000     0
    0.22666666664400    0.22666666664400    0.00000000000000     0
    0.21333333331200    0.21333333331200    0.00000000000000     0
    0.19999999998000    0.19999999998000    0.00000000000000     0
    0.18666666664800    0.18666666664800    0.00000000000000     0
    0.17333333331600    0.17333333331600    0.00000000000000     0
    0.15999999998400    0.15999999998400    0.00000000000000     0
    0.14666666665200    0.14666666665200    0.00000000000000     0
    0.13333333332000    0.13333333332000    0.00000000000000     0
    0.11999999998800    0.11999999998800    0.00000000000000     0
    0.10666666665600    0.10666666665600    0.00000000000000     0
    0.09333333332400    0.09333333332400    0.00000000000000     0
    0.07999999999200    0.07999999999200    0.00000000000000     0
    0.06666666666000    0.06666666666000    0.00000000000000     0
    0.05333333332800    0.05333333332800    0.00000000000000     0
    0.03999999999600    0.03999999999600    0.00000000000000     0
    0.02666666666400    0.02666666666400    0.00000000000000     0
    0.01333333333200    0.01333333333200    0.00000000000000     0
    0.00000000000000    0.00000000000000    0.00000000000000     0
</code></pre><p>(3) Do PBE calculation. Can be skip.</p>
<p>(4) Do hybird functional band structure calculation. The detail of INCAR parameters are discussed in <a href="http://blog.wangruixing.cn/2019/05/20/hse/" target="_blank" rel="noopener">http://blog.wangruixing.cn/2019/05/20/hse/</a> , INCAR:</p>
<pre><code>##### initial I/O #####
SYSTEM = Hybird Functional
# KPAR = 4       
NCORE = 5 
ISTART = 1 
ICHARG = 1 
LWAVE = .TRUE. 
LCHARG = .TRUE.
LVTOT = .FALSE.
LVHAR = .FALSE.
LELF = .FALSE. 
LORBIT = 11 
NEDOS = 1000

##### SCF #####
ENCUT = 500
ISMEAR = 0 
SIGMA = 0.05
EDIFF = 1E-6
NELMIN = 5 
NELM = 300 
GGA = PE 
LREAL = .FALSE.
# PREC = Accurate
# ISYM = 3

##### Geo opt #####
EDIFFG = -0.01
IBRION = 2
POTIM = 0.2 
NSW = 0 # no Geo_opt
ISIF = 3  # 2 not optimize cell

#### HSE ####
LHFCALC = .TRUE. 
AEXX   =  0.25        
HFSCREEN = 0.2         
ALGO = ALL # or Damped
TIME   =  0.4
</code></pre><p>(5) Run <strong>252 </strong>(note: bug in 0.73 version, please use 0.72p1 or 0.74 version)</p>
<pre><code>252
  --&gt;&gt; (01) Reading Input Parameters From INCAR File...
  --&gt;&gt; (02) Reading Fermi-Energy from DOSCAR File...
 ooooooooo The Fermi Energy will be set to zero eV ooooooooooooooo
  --&gt;&gt; (03) Reading Energy-Levels From EIGENVAL File...
  --&gt;&gt; (04) Reading Structural Parameters from POSCAR File...
  --&gt;&gt; (05) Reading K-Paths From KPATH.in File...
  --&gt;&gt; (06) Written BAND.dat File!
  --&gt;&gt; (07) Written BAND_REFORMATTED.dat File!
  --&gt;&gt; (08) Written KLINES.dat File!
  --&gt;&gt; (09) Written KLABELS File!
  --&gt;&gt; (10) Written BAND_GAP File!
 If you want use the default setting, type 0, if modity type 1
0
  --&gt;&gt; (11) Graph has been generated!
</code></pre><p>if the python and matplotlib enviornment is set correctly. vaspkit will draw a band figure <code>band.png</code>. Following parameters should be set in ~/.vaspkit file.</p>
<pre><code>PYTHON_VERSION           3 
PLOT_MATPLOTLIB          .TURE.
</code></pre><p><img src="/images/vaspkit-hse-band/vaspkit-hse-band1.png" alt></p>
<p>You can also draw the figure from BAND.dat or BAND_REFORMATTED.dat by origin.</p>
<p><img src="/images/vaspkit-hse-band/vaspkit-hse-band2.png" alt></p>
<p>By comparing with the line-mode of KPOINTS, which cannot adjust the k points number between high symmetery points. KPOINTS generated from vaspkit <strong>251</strong> keeps the spacing between every k points. So, one can use less 0-weighted k points to get a similar qualified band structure, and thus, take less time when doing band structure calculations.</p>
<p>Band structure calculated with line-mode with 50 points between high symmetery points:</p>
<p><img src="/images/vaspkit-hse-band/vaspkit-hse-band3.png" alt></p>
<p><strong>To get projected hybrid functional band structure, please use 253，254，255</strong>：</p>
<pre><code> 253) Get Projected Band-Structure for Selected Atoms            
 254) Get Projected Band-Structure for Each ELement              
 255) Get the Sum of Projected Band-Structure for Selected Atoms
</code></pre><p>For example:  by using <strong>253</strong>, a free format input is available. You can input any atoms by its index and any elements symbol. Projected band structure will saved for each elements one by one.</p>
<pre><code>  --&gt;&gt; (01) Reading Input Parameters From INCAR File...
  --&gt;&gt; (02) Reading Fermi-Energy from DOSCAR File...
 ooooooooo The Fermi Energy will be set to zero eV ooooooooooooooo
  --&gt;&gt; (03) Reading Structural Parameters from POSCAR File...
  --&gt;&gt; (04) Reading Energy-Levels From EIGENVAL File...
  --&gt;&gt; (05) Reading Band-Weights From PROCAR File...
  --&gt;&gt; (06) Reading K-Paths From KPATH.in File...
 |---------------------------------------------------------------|
 Input the element-symbol and/or atom-index to SUM [Total-atom: 3]
 (Free Format is OK, e.g., C Fe H 1-4 7 8 24)

 ------------&gt;&gt;
1-3
  --&gt;&gt; (07) Written SELECTED_ATOM_LIST File!
  --&gt;&gt; (08) Written PBAND_A1.dat File!
  --&gt;&gt; (09) Written PBAND_A2.dat File!
  --&gt;&gt; (10) Written PBAND_A3.dat File!
  --&gt;&gt; (11) Written KLINES.dat File!
  --&gt;&gt; (12) Written KLABELS File!
</code></pre><p>Elements projected band structure obtained by using  <strong>254</strong>, </p>
<pre><code>254
  --&gt;&gt; (01) Reading Input Parameters From INCAR File...
  --&gt;&gt; (02) Reading Fermi-Energy from DOSCAR File...
 ooooooooo The Fermi Energy will be set to zero eV ooooooooooooooo
  --&gt;&gt; (03) Reading Structural Parameters from POSCAR File...
  --&gt;&gt; (04) Reading Energy-Levels From EIGENVAL File...
  --&gt;&gt; (05) Reading Band-Weights From PROCAR File...
  --&gt;&gt; (06) Reading K-Paths From KPATH.in File...
  --&gt;&gt; (07) Written PBAND_S.dat File!
  --&gt;&gt; (08) Written PBAND_Mo.dat File!
  --&gt;&gt; (09) Written KLINES.dat File!
  --&gt;&gt; (10) Written KLABELS File!
</code></pre><p>All your input atoms will be sumed up and are projected to the band structure by using <strong>255</strong>:</p>
<pre><code>255

  --&gt;&gt; (01) Reading Input Parameters From INCAR File...
  --&gt;&gt; (02) Reading Fermi-Energy from DOSCAR File...
 ooooooooo The Fermi Energy will be set to zero eV ooooooooooooooo
  --&gt;&gt; (03) Reading Structural Parameters from POSCAR File...
  --&gt;&gt; (04) Reading Energy-Levels From EIGENVAL File...
  --&gt;&gt; (05) Reading Band-Weights From PROCAR File...
  --&gt;&gt; (06) Reading K-Paths From KPATH.in File...
 |---------------------------------------------------------------|
 Input the element-symbol and/or atom-index to SUM [Total-atom: 3]
 (Free Format is OK, e.g., C Fe H 1-4 7 8 24)

 ------------&gt;&gt;
1-2
  --&gt;&gt; (07) Written SELECTED_ATOM_LIST File!
  --&gt;&gt; (08) Written PBAND_SUM.dat File!
  --&gt;&gt; (09) Written KLINES.dat File!
  --&gt;&gt; (10) Written KLABELS File!
</code></pre><p>To draw figures, please refer:     </p>
<p><a href="http://blog.wangruixing.cn/2019/05/19/pband/" target="_blank" rel="noopener">http://blog.wangruixing.cn/2019/05/19/pband/</a></p>
<p><a href="http://blog.wangruixing.cn/2019/05/14/band/" target="_blank" rel="noopener">http://blog.wangruixing.cn/2019/05/14/band/</a></p>
<p><a href="http://blog.wangruixing.cn/2019/05/19/pymatgen-band/" target="_blank" rel="noopener">http://blog.wangruixing.cn/2019/05/19/pymatgen-band/</a></p>
<h2 id="supplementary-hybrid-functional-band-structure-can-also-be-down-by-pymatgen"><a href="#supplementary-hybrid-functional-band-structure-can-also-be-down-by-pymatgen" class="headerlink" title="supplementary: hybrid functional band structure can also be down by pymatgen:"></a>supplementary: hybrid functional band structure can also be down by pymatgen:</h2><p><img src="/images/vaspkit-hse-band/vaspkit-hse-band4.png" alt></p>

      
       <hr><span style="font-style: italic;color: gray;"> 转载请注明来源，欢迎对文章中的引用来源进行考证，欢迎指出任何有错误或不够清晰的表达。可以可以邮件至 vaspkit@gmail.com </span>
    </div>
</article>


<p>
    <a href="javascript:void(0)" class="dashang" onclick="dashangToggle()">赏</a>
</p>


<div class="article_copyright">
    <p><span>文章标题:</span>Band Structure calculation (Hybird functional)</p>
    
    <p><span>本文作者:</span><a href="javascript:void(0)" title="VASPKIT">VASPKIT</a></p>
    <p><span>发布时间:</span>2019-05-22, 00:00:00</p>
    <p><span>最后更新:</span>2019-06-19, 21:15:04</p>
    <span>原始链接:</span><a class="post-url" href="/2019/05/22/vaspkit-hse-band/" title="Band Structure calculation (Hybird functional)">http://vaspkit.com/2019/05/22/vaspkit-hse-band/</a>
    <p>
        <span>版权声明:</span><i class="fa fa-creative-commons"></i> <a rel="license" href="http://creativecommons.org/licenses/by-nc-sa/4.0/" title="CC BY-NC-SA 4.0 International" target="_blank">"署名-非商用-相同方式共享 4.0"</a> 转载请保留原文链接及作者。
    </p>
</div>




    




    </div>
    <div class="copyright">
        <p class="footer-entry">©2016-2019 Yelog</p>
<p class="footer-entry">Built with <a href="https://hexo.io/" target="_blank">Hexo</a> and <a href="https://github.com/yelog/hexo-theme-3-hexo" target="_blank">3-hexo</a> theme</p>

    </div>
    <div class="full-toc">
        <button class="full"><span class="min "></span></button>
<button class="post-toc-menu"><span class="post-toc-menu-icons"></span></button>
<div class="post-toc"><span class="post-toc-title">目录</span>
    <div class="post-toc-content">

    </div>
</div>
<a class id="rocket" href="javascript:void(0)"></a>
    </div>
</div>
<div class="acParent"></div>

<div class="hide_box" onclick="dashangToggle()"></div>
<div class="shang_box">
    <a class="shang_close" href="javascript:void(0)" onclick="dashangToggle()">×</a>
    <div class="shang_tit">
        <p>喜欢就点赞,疼爱就打赏</p>
    </div>
    <div class="shang_payimg">
        <div class="pay_img">
            <img src="/img/alipay.jpg" class="alipay" title="扫码支持">
            <img src="/img/weixin.jpg" class="weixin" title="扫码支持">
        </div>
    </div>
    <div class="shang_payselect">
        <span><label><input type="radio" name="pay" checked value="alipay">支付宝</label></span><span><label><input type="radio" name="pay" value="weixin">微信</label></span>
    </div>
</div><!-- hexo-inject:begin --><!-- hexo-inject:end -->


</body>
<script src="//cdn.bootcss.com/jquery.pjax/2.0.1/jquery.pjax.min.js"></script>

<script src="/js/script.js?v=1"></script>
<script>
    var img_resize = 'default';
    /*作者、标签的自动补全*/
    $(function () {
        $('.search').AutoComplete({
            'data': ['@V. Wang','@Nan Xu','#VASP','#能带','#vaspkit','#Band structure',],
            'itemHeight': 20,
            'width': 418
        }).AutoComplete('show');
    })
    function initArticle() {
        /*渲染对应的表格样式*/
        
            $(".post .pjax table").addClass("green_title");
        

        /*渲染打赏样式*/
        
        $("input[name=pay]").on("click", function () {
            if($("input[name=pay]:checked").val()=="weixin"){
                $(".shang_box .shang_payimg .pay_img").addClass("weixin_img");
            } else {
                $(".shang_box .shang_payimg .pay_img").removeClass("weixin_img");
            }
        })
        

        /*高亮代码块行号*/
        
        $('pre code').each(function(){
            var lines = $(this).text().split('\n').length - 1;
            var $numbering = $('<ul/>').addClass('pre-numbering').attr("unselectable","on");
            $(this).addClass('has-numbering')
                    .parent()
                    .append($numbering);
            for(i=1;i<=lines;i++){
                $numbering.append($('<li/>').text(i));
            }
        });
        

        /*访问数量*/
        
        $.getScript("//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js");
        

        /*代码高亮，行号对齐*/
        $('.pre-numbering').css('line-height',$('.has-numbering').css('line-height'));

        
    }

    /*打赏页面隐藏与展示*/
    
    function dashangToggle() {
        $(".shang_box").fadeToggle();
        $(".hide_box").fadeToggle();
    }
    

</script>

<!--加入行号的高亮代码块样式-->

<style>
    pre{
        position: relative;
        margin-bottom: 24px;
        border-radius: 10px;
        border: 1px solid #e2dede;
        background: #FFF;
        overflow: hidden;
    }
    code.has-numbering{
        margin-left: 30px;
    }
    .pre-numbering{
        margin: 0px;
        position: absolute;
        top: 0;
        left: 0;
        width: 20px;
        padding: 0.5em 3px 0.7em 5px;
        border-right: 1px solid #C3CCD0;
        text-align: right;
        color: #AAA;
        background-color: #fafafa;
    }
</style>

<!--自定义样式设置-->
<style>
    
    .nav-right nav a.hover, #local-search-result a.hover{
        background-color: #e2e0e0;
    }
    
    

    /*列表样式*/
    
    .post .pjax article .article-entry>ol, .post .pjax article .article-entry>ul, .post .pjax article>ol, .post .pjax article>ul{
        border: #e2dede solid 1px;
        border-radius: 10px;
        padding: 10px 32px 10px 56px;
    }
    .post .pjax article .article-entry li>ol, .post .pjax article .article-entry li>ul,.post .pjax article li>ol, .post .pjax article li>ul{
        padding-top: 5px;
        padding-bottom: 5px;
    }
    .post .pjax article .article-entry>ol>li, .post .pjax article .article-entry>ul>li,.post .pjax article>ol>li, .post .pjax article>ul>li{
        margin-bottom: auto;
        margin-left: auto;
    }
    .post .pjax article .article-entry li>ol>li, .post .pjax article .article-entry li>ul>li,.post .pjax article li>ol>li, .post .pjax article li>ul>li{
        margin-bottom: auto;
        margin-left: auto;
    }
    

    /* 背景图样式 */
    
    


    /*引用块样式*/
    
    .post .pjax article blockquote {
        padding: 10px 20px;
        background-color: white;
        border: none;
        border-left: 4px solid #42b983;
        border-right: 4px solid #42b983;
        border-radius: 10px;
    }
    

    /*文章列表背景图*/
    
    .nav-right:before {
        content: ' ';
        display: block;
        position: absolute;
        left: 0;
        top: 0;
        width: 100%;
        height: 100%;
        opacity: 0.1;
        background: url("http://img.xiangzhangshugongyi.com/FlSExUGfRSaqxkK5v42CpuI-tXAL.jpg");
        background-repeat: no-repeat;
        background-position: 50% 0;
        -ms-background-size: cover;
        -o-background-size: cover;
        -moz-background-size: cover;
        -webkit-background-size: cover;
        background-size: cover;
    }
    

    
</style>







</html>
